<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Contato — Cyber Vault</title>
  <link rel="stylesheet" href="style.css"/>
</head>
<body>
  <header><h2>Cyber Vault — Contato</h2></header>

  <main style="padding:24px; max-width:600px; margin:auto;">

    <h1>Cadastro / Login</h1>

    <!-- Formulário de cadastro -->
    <form id="cadastroForm">
      <label>Nome:</label><br/>
      <input type="text" name="nome" required/><br/>
      <label>Telefone:</label><br/>
      <input type="text" name="telefone" required/><br/>
      <label>E-mail:</label><br/>
      <input type="email" name="email" required/><br/>
      <label>Senha:</label><br/>
      <input type="password" name="senha" required/><br/>
      <button type="submit">Cadastrar</button>
    </form>
    <div id="cadMsg"></div>

    <hr/>

    <!-- Formulário de login -->
    <form id="loginForm">
      <label>Nome:</label><br/>
      <input type="text" name="nome" required/><br/>
      <label>Senha:</label><br/>
      <input type="password" name="senha" required/><br/>
      <button type="submit">Login</button>
    </form>
    <div id="loginMsg"></div>

    <h2 id="bemvindo" style="margin-top:24px;"></h2>

  </main>

  <footer style="text-align:center; padding:12px;">© 2025 Cyber Vault</footer>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbzXH7yPLftYDFzNsfLngNsUFG5-XZhZheEndk675YczHmHp0KRC2Ebw7wTH0brywmqu/exec";

document.getElementById("cadastroForm").addEventListener("submit", async e => {
  e.preventDefault();
  const fd = new FormData(e.target);
  const data = {
    nome: fd.get("nome"),
    telefone: fd.get("telefone"),
    email: fd.get("email"),
    senha: fd.get("senha")
  };
  try {
    const res = await fetch(API_URL, {
      method: "POST",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify(data)
    });
    const j = await res.json();
    document.getElementById("cadMsg").textContent = j.status === "OK" ? "Cadastro realizado!" : "Erro: " + (j.erro||"");
  } catch(err) {
    document.getElementById("cadMsg").textContent = "Erro de rede.";
  }
});

document.getElementById("loginForm").addEventListener("submit", async e => {
  e.preventDefault();
  const nome = e.target.nome.value.trim();
  const senha = e.target.senha.value.trim();
  try {
    const res = await fetch(API_URL + "?action=listar");
    const users = await res.json();
    const u = users.find(u => u.nome === nome && u.senha === senha);
    if (!u) {
      document.getElementById("loginMsg").textContent = "Usuário ou senha incorretos.";
      return;
    }
    document.getElementById("bemvindo").textContent = "Bem-vindo, " + u.nome + "!";
    document.getElementById("loginMsg").textContent = "";
  } catch(err) {
    document.getElementById("loginMsg").textContent = "Erro de rede.";
  }
});
</script>
</body>
</html>
